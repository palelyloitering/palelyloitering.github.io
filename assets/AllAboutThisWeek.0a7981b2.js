import{a7 as $,a1 as g,a8 as y,a4 as M,a3 as W,a9 as u,aa as k,ab as d,a5 as i,ac as q,ad as x,a6 as N,Q as B,a2 as R}from"./index.eccf5831.js";import{Q as L}from"./QPageSticky.f952072d.js";import{Q as Y,a as F}from"./QCard.993d684b.js";import{_ as E}from"./RememberItemLook.1f705b98.js";import"./date_extensions.c8e8be1e.js";import{c as Q,q as c,o as f,d as H,H as b,w as p,g as D,f as K,a as T,b as j,u as U}from"./storeYahrzeits.76df02a8.js";import{_ as V}from"./plugin-vue_export-helper.21dcd24c.js";import"./use-dark.8fb4523a.js";const h=Q(H,"shulMembers");c(h,f("edate","desc"));const O=$("storeShulMembersDB",{state:()=>({currentWeek:[],shul:[],members:{},tempMembers:{},results:[],listResults:{}}),actions:{async setCurrentWeek(s){const t=new b(s).onOrBefore(6);this.currentWeek=[];for(let r=0;r<7;r++){let n=t.add(r,"day");this.currentWeek.push(n)}return console.log("My week is",this.currentWeek),this.currentWeek},async getShulMembersForWC_other(){for(const s in this.currentWeek){let e=[];console.log(this.currentWeek[s],"is where we zre in current week");let t=new b(this.currentWeek[s]);console.log("yahrzeit is",t),e=await this.getShulMembersForHDay(t),console.log("the sub-proc returned",e),this.members[s]=e}return this.members},async getShulMembersForList(s){let e={};console.log(s);for(const t of s)if(typeof t=="string"){console.log("We have a string now. Key: "+t+", actualDay: "+t);const r=c(h,p("haShavuaDates","array-contains",t),f("shulMemberSurname")),a=(await D(r)).docs.map(o=>o.data());e[t]=a,this.$patch({listResults:e})}else for(const[r,n]of Object.entries(t))if(Array.isArray(n)){if(n.length===1){const a=c(h,p("haShavuaDates","array-contains",n[0]),f("shulMemberSurname")),l=(await D(a)).docs.map(m=>m.data());e[r]=l,this.$patch({listResults:e})}if(n.length===2){const a=c(h,p("haShavuaDates","array-contains",n[0]),f("shulMemberSurname")),o=c(h,p("haShavuaDates","array-contains",n[1]),f("shulMemberSurname")),m=(await D(a)).docs.map(w=>w.data()),z=(await D(o)).docs.map(w=>w.data());let v=[...m,...z];v.sort(function(w,_){return w.shulMemberSurname<_.shulMemberSurname?-1:w.shulMemberSurname>_.shulMemberSurname?1:0}),e[r]=v,this.$patch({listResults:e})}else if(n.length===3){const a=c(h,p("haShavuaDates","array-contains",n[0]),f("shulMemberSurname")),o=c(h,p("haShavuaDates","array-contains",n[1]),f("shulMemberSurname")),l=c(h,p("haShavuaDates","array-contains",n[2]),f("shulMemberSurname")),A=(await D(a)).docs.map(S=>S.data()),v=(await D(o)).docs.map(S=>S.data()),_=(await D(l)).docs.map(S=>S.data());let I=[...A,...v,..._];I.sort(function(S,C){return S.shulMemberSurname<C.shulMemberSurname?-1:S.shulMemberSurname>C.shulMemberSurname?1:0}),e[r]=I,this.$patch({listResults:e})}}},async getShulMembersForWC(){for(const s in this.currentWeek){let e=[],t=K(this.currentWeek[s]);const r=await c(h,p("haShavuaDates","array-contains",t),f("shulMemberSurname"));T(r,n=>{n.docs.map(o=>o.data()).forEach(o=>e.push(o.shulMemberFullName)),e=[...new Set(e)],console.log("dayResults is",e," and n is",s),this.members[s]=e}),this.members[s]=e}return this.members},async getAllShulMembers(){const s=await c(h);return T(s,e=>{e.forEach(t=>{let r={...t.data()};r.identifier=t.id,this.members[t.data().shulMemberSubRef]=r})}),this.members},async addTempShulMember(s,e){let r=[e.date];s.haShavuaDates=r;let n=[];n.push(e),s.yahrzeits=n;let a={};a[s.shulMemberSubRef]=s,this.$patch({tempMembers:a})},async updateTempShulMember(s,e){let t={},r=this.tempMembers[s];const n=e.date;let a=r.haShavuaDates;a.push(n),r.haShavuaDates=a;let o=r.yahrzeits;o.push(e),r.yahrzeits=o,t[s]=r,this.$patch({tempMembers:t})},async writeTempDataToCloud(){for(let[s,e]of Object.entries(this.tempMembers)){console.log(`${s}`),e.updateDate=new Date;const t=await j(h,e);console.log("Document written with ID: ",t.id)}},async getShulMembersForSurname(s){console.log("I'm here with",s);const e=await c(h,p("shulMemberSurname","==",s));return console.log(e),T(e,t=>{t.forEach(r=>{console.log(r.data());let n={...r.data()};n.identifier=r.id,this.results.push(n)})}),this.results},async getShulMembersForHDay(s){this.results=[],console.log("I zeroed results and it is now",this.results);let e=s.getDate();e=e.toString().padStart(2,"0");let t=s.getMonthName();t=t.replace("Iyyar","Iyar").replace("Nisan","Nissan").replace("Tevet","Teveth").replace("Sh'vat","Shevat").replace("Tamuz","Tammuz").replace("Elul","Ellul").replace("Tishrei","Tishri").replace("Adar I","Adar 1").replace("Adar II","Adar 2");let r=e+" "+t;console.log("yahrzeit is",r);const n=await c(h,p("haShavuaDates","array-contains",r));return console.log("q is",n),T(n,a=>{a.forEach(o=>{console.log("result is ",o.data());let l={...o.data()};l.identifier=o.id,this.results.push(l)})}),console.log("and at the end of the subproc",this.results),this.results}}});const P={class:"page",width:"100%","full-height":""},G={class:"header q-ma-none",align:"center"},J={class:"q-my-none q-mx-sm align-center text-h5"},X={class:"row q-mx-md q-mb-md items-center"},Z={class:"row justify-left"},ee={class:"text-left text-h6 text-bold indigo-8"},te={class:"text-h7"},ae={__name:"AllAboutThisWeek",setup(s){const e=U(),t=O(),r=()=>{e.getTodayYahrzeits(),e.getWeeksYarhzeits(new b),t.getShulMembersForWC()};return t.setCurrentWeek(new Date),r(),(n,a)=>(g(),y("div",P,[M(L,{position:"top-right",offset:[5,5]},{default:W(()=>[M(B,{fab:"",onClick:a[0]||(a[0]=o=>n.$q.fullscreen.toggle()),icon:n.$q.fullscreen.isActive?"fullscreen_exit":"fullscreen"},null,8,["icon"])]),_:1}),u("h5",G,[a[1]||(a[1]=k(" Today is ")),u("b",null,d(new Date().toDateString()),1),a[2]||(a[2]=k(". This is ")),u("b",null,d(new(i(b))().render("en",!0)),1),a[3]||(a[3]=k(", and after sunset, ")),u("b",null,d(new(i(b))().add(1).render("en",!1)),1)]),a[7]||(a[7]=u("br",null,null,-1)),(g(!0),y(q,null,x(i(e).thisWeek,(o,l)=>(g(),y("div",{key:l},[u("div",J,d(new(i(b))(Number(l)).greg().toLocaleDateString("en-UK",{weekday:"long",day:"numeric",month:"long"}))+" - "+d(new(i(b))(Number(l))),1),u("div",X,[(g(!0),y(q,null,x(o,m=>(g(),R(E,{key:m.id,ename:m.ename,hname:m.hname,look:"l5"},null,8,["ename","hname"]))),128))])]))),128)),a[8]||(a[8]=u("br",null,null,-1)),N("",!0),M(Y,{class:"q-mx-xl"},{default:W(()=>[M(F,null,{default:W(()=>a[5]||(a[5]=[u("div",{class:"text-bold text-h6"}," The Congregation wishes \u201CLong Life\u201D to all those who are commemorating a Yahrzeit in the coming week ",-1)])),_:1}),M(F,null,{default:W(()=>[u("div",Z,[(g(!0),y(q,null,x(i(t).members,(o,l)=>(g(),y("ul",{key:o,class:"q-px-md q-py-none text-h7"},[u("li",ee,[k(d(i(t).currentWeek[l]),1),u("span",te,[a[6]||(a[6]=u("br",null,null,-1)),k("("+d(new(i(b))(i(t).currentWeek[l]).subtract(1,"d").greg().toLocaleDateString("en-UK",{weekday:"short",day:"numeric"}))+" - "+d(new(i(b))(i(t).currentWeek[l]).greg().toLocaleDateString("en-UK",{weekday:"short",day:"numeric"}))+" "+d(new(i(b))(i(t).currentWeek[l]).greg().toLocaleDateString("en-UK",{month:"short"}))+")",1)])]),u("ul",null,[(g(!0),y(q,null,x(o,m=>(g(),y("li",{key:m},d(m),1))),128))])]))),128))])]),_:1})]),_:1})]))}};var ce=V(ae,[["__scopeId","data-v-6a9ca6b8"]]);export{ce as default};
