import{X as $,R as g,Y as y,V as M,U as W,Z as u,_ as k,$ as d,a0 as i,a1 as q,a2 as x,a3 as N,Q as R,S as B}from"./index.8c5703e8.js";import{Q as Y}from"./QPageSticky.61c16f6b.js";import{Q as L,a as F}from"./QCard.ef600d51.js";import{_ as E}from"./RememberItemLook.17dd731d.js";import"./date_extensions.6f1a8f5a.js";import{c as Q,q as c,o as f,d as H,H as b,w as p,g as D,f as K,a as T,b as U,u as V}from"./storeYahrzeits.23e89a58.js";import{_ as j}from"./plugin-vue_export-helper.21dcd24c.js";import"./use-dark.0f7e0fc8.js";const h=Q(H,"shulMembers");c(h,f("edate","desc"));const O=$("storeShulMembersDB",{state:()=>({currentWeek:[],shul:[],members:{},tempMembers:{},results:[],listResults:{}}),actions:{async setCurrentWeek(a){const t=new b(a).onOrBefore(6);this.currentWeek=[];for(let r=0;r<7;r++){let n=t.add(r,"day");this.currentWeek.push(n)}return console.log("My week is",this.currentWeek),this.currentWeek},async getShulMembersForWC_other(){for(const a in this.currentWeek){let e=[];console.log(this.currentWeek[a],"is where we zre in current week");let t=new b(this.currentWeek[a]);console.log("yahrzeit is",t),e=await this.getShulMembersForHDay(t),console.log("the sub-proc returned",e),this.members[a]=e}return this.members},async getShulMembersForList(a){let e={};console.log(a);for(const t of a)if(typeof t=="string"){console.log("We have a string now. Key: "+t+", actualDay: "+t);const r=c(h,p("haShavuaDates","array-contains",t),f("shulMemberSurname")),s=(await D(r)).docs.map(o=>o.data());e[t]=s,this.$patch({listResults:e})}else for(const[r,n]of Object.entries(t))if(Array.isArray(n)){if(n.length===1){const s=c(h,p("haShavuaDates","array-contains",n[0]),f("shulMemberSurname")),l=(await D(s)).docs.map(m=>m.data());e[r]=l,this.$patch({listResults:e})}if(n.length===2){const s=c(h,p("haShavuaDates","array-contains",n[0]),f("shulMemberSurname")),o=c(h,p("haShavuaDates","array-contains",n[1]),f("shulMemberSurname")),m=(await D(s)).docs.map(w=>w.data()),z=(await D(o)).docs.map(w=>w.data());let v=[...m,...z];v.sort(function(w,_){return w.shulMemberSurname<_.shulMemberSurname?-1:w.shulMemberSurname>_.shulMemberSurname?1:0}),e[r]=v,this.$patch({listResults:e})}else if(n.length===3){const s=c(h,p("haShavuaDates","array-contains",n[0]),f("shulMemberSurname")),o=c(h,p("haShavuaDates","array-contains",n[1]),f("shulMemberSurname")),l=c(h,p("haShavuaDates","array-contains",n[2]),f("shulMemberSurname")),A=(await D(s)).docs.map(S=>S.data()),v=(await D(o)).docs.map(S=>S.data()),_=(await D(l)).docs.map(S=>S.data());let I=[...A,...v,..._];I.sort(function(S,C){return S.shulMemberSurname<C.shulMemberSurname?-1:S.shulMemberSurname>C.shulMemberSurname?1:0}),e[r]=I,this.$patch({listResults:e})}}},async getShulMembersForWC(){for(const a in this.currentWeek){let e=[],t=K(this.currentWeek[a]);const r=await c(h,p("haShavuaDates","array-contains",t),f("shulMemberSurname"));T(r,n=>{n.docs.map(o=>o.data()).forEach(o=>e.push(o.shulMemberFullName)),e=[...new Set(e)],console.log("dayResults is",e," and n is",a),this.members[a]=e}),this.members[a]=e}return this.members},async getAllShulMembers(){const a=await c(h);return T(a,e=>{e.forEach(t=>{let r={...t.data()};r.identifier=t.id,this.members[t.data().shulMemberSubRef]=r})}),this.members},async addTempShulMember(a,e){let r=[e.date];a.haShavuaDates=r;let n=[];n.push(e),a.yahrzeits=n;let s={};s[a.shulMemberSubRef]=a,this.$patch({tempMembers:s})},async updateTempShulMember(a,e){let t={},r=this.tempMembers[a];const n=e.date;let s=r.haShavuaDates;s.push(n),r.haShavuaDates=s;let o=r.yahrzeits;o.push(e),r.yahrzeits=o,t[a]=r,this.$patch({tempMembers:t})},async writeTempDataToCloud(){for(let[a,e]of Object.entries(this.tempMembers)){console.log(`${a}`),e.updateDate=new Date;const t=await U(h,e);console.log("Document written with ID: ",t.id)}},async getShulMembersForSurname(a){console.log("I'm here with",a);const e=await c(h,p("shulMemberSurname","==",a));return console.log(e),T(e,t=>{t.forEach(r=>{console.log(r.data());let n={...r.data()};n.identifier=r.id,this.results.push(n)})}),this.results},async getShulMembersForHDay(a){this.results=[],console.log("I zeroed results and it is now",this.results);let e=a.getDate();e=e.toString().padStart(2,"0");let t=a.getMonthName();t=t.replace("Iyyar","Iyar").replace("Nisan","Nissan").replace("Tevet","Teveth").replace("Sh'vat","Shevat").replace("Tamuz","Tammuz").replace("Elul","Ellul").replace("Tishrei","Tishri").replace("Adar I","Adar 1").replace("Adar II","Adar 2");let r=e+" "+t;console.log("yahrzeit is",r);const n=await c(h,p("haShavuaDates","array-contains",r));return console.log("q is",n),T(n,s=>{s.forEach(o=>{console.log("result is ",o.data());let l={...o.data()};l.identifier=o.id,this.results.push(l)})}),console.log("and at the end of the subproc",this.results),this.results}}});const P={class:"page",width:"100%","full-height":""},X={class:"header q-ma-none",align:"center"},Z={class:"q-my-none q-mx-sm align-center text-h5"},G={class:"row q-mx-md q-mb-md items-center"},J={class:"row justify-left"},ee={class:"text-left text-h6 text-bold indigo-8"},te={class:"text-h7"},se={__name:"AllAboutThisWeek",setup(a){const e=V(),t=O(),r=()=>{e.getTodayYahrzeits(),e.getWeeksYarhzeits(new b),t.getShulMembersForWC()};return t.setCurrentWeek(new Date),r(),(n,s)=>(g(),y("div",P,[M(Y,{position:"top-right",offset:[5,5]},{default:W(()=>[M(R,{fab:"",onClick:s[0]||(s[0]=o=>n.$q.fullscreen.toggle()),icon:n.$q.fullscreen.isActive?"fullscreen_exit":"fullscreen"},null,8,["icon"])]),_:1}),u("h5",X,[s[1]||(s[1]=k(" Today is ")),u("b",null,d(new Date().toDateString()),1),s[2]||(s[2]=k(". This is ")),u("b",null,d(new(i(b))().render("en",!0)),1),s[3]||(s[3]=k(", and after sunset, ")),u("b",null,d(new(i(b))().add(1).render("en",!1)),1)]),s[7]||(s[7]=u("br",null,null,-1)),(g(!0),y(q,null,x(i(e).thisWeek,(o,l)=>(g(),y("div",{key:l},[u("div",Z,d(new(i(b))(Number(l)).greg().toLocaleDateString("en-UK",{weekday:"long",day:"numeric",month:"long"}))+" - "+d(new(i(b))(Number(l))),1),u("div",G,[(g(!0),y(q,null,x(o,m=>(g(),B(E,{key:m.id,ename:m.ename,hname:m.hname,look:"l5"},null,8,["ename","hname"]))),128))])]))),128)),s[8]||(s[8]=u("br",null,null,-1)),N("",!0),M(L,{class:"q-mx-xl"},{default:W(()=>[M(F,null,{default:W(()=>s[5]||(s[5]=[u("div",{class:"text-bold text-h6"}," The Congregation wishes \u201CLong Life\u201D to all those who are commemorating a Yahrzeit in the coming week ",-1)])),_:1}),M(F,null,{default:W(()=>[u("div",J,[(g(!0),y(q,null,x(i(t).members,(o,l)=>(g(),y("ul",{key:o,class:"q-px-md q-py-none text-h7"},[u("li",ee,[k(d(i(t).currentWeek[l]),1),u("span",te,[s[6]||(s[6]=u("br",null,null,-1)),k("("+d(new(i(b))(i(t).currentWeek[l]).subtract(1,"d").greg().toLocaleDateString("en-UK",{weekday:"short",day:"numeric"}))+" - "+d(new(i(b))(i(t).currentWeek[l]).greg().toLocaleDateString("en-UK",{weekday:"short",day:"numeric"}))+" "+d(new(i(b))(i(t).currentWeek[l]).greg().toLocaleDateString("en-UK",{month:"short"}))+")",1)])]),u("ul",null,[(g(!0),y(q,null,x(o,m=>(g(),y("li",{key:m},d(m),1))),128))])]))),128))])]),_:1})]),_:1})]))}};var ce=j(se,[["__scopeId","data-v-6a9ca6b8"]]);export{ce as default};
